groups:
- name: postgres-alerts
  rules:

  - alert: PostgresHighConnections
    expr: pg_stat_activity_count / pg_setting_max_connections > 0.8
    for: 1m
    labels:
      severity: warning
    annotations:
      description: "Postgres connections > 80%"
  
  - alert: PostgresReplicationLag
    expr: pg_replication_lag_seconds > 10
    for: 30s
    labels:
      severity: critical
    annotations:
      description: "Replication lag > 10s"